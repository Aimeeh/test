@{
    //ViewBag.Title = "Index";
    Layout = null;
}
<!DOCTYPE html>
<html lang="en">
<head>
    <title>成都汉维斯流量数据采集系统</title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link href="~/Content/img/favicon.ico" rel="shortcut icon" type="image/x-icon" />
    <link href="~/Content/css/bootstrap.min.css" rel="stylesheet" />
    <link href="~/Content/css/bootstrap-responsive.min.css" rel="stylesheet" />
    <link href="~/Content/css/uniform.css" rel="stylesheet" />
    <link href="~/Content/css/select2.css" rel="stylesheet" />
    <link href="~/Content/css/fullcalendar.css" rel="stylesheet" />
    <link href="~/Content/css/matrix-style.css" rel="stylesheet" />
    <link href="~/Content/css/matrix-media.css" rel="stylesheet" />
    <link href="~/Content/font-awesome/css/font-awesome.css" rel="stylesheet" />
    <link href="~/Content/css/jquery.gritter.css" rel="stylesheet" />
    <link href="~/Content/css/bootstrap-table.css" rel="stylesheet" />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,700,800' rel='stylesheet' type='text/css'>
    <style>
        .area {
            color: #982F4D;
            font-weight: 700;
            font-size: 15px;
            margin-left: 1.5rem;
            /*width: 20%;*/
            float: left;
            margin-left: 6rem;
            margin-top: 0.5rem;
        }

        .hidden{
            display:none;
        }
        .uhidden{
            display:block;
        }

        .select_bor {
            /*border: solid 1px #a9b2b3;*/
            width: 30%;
            margin-left: 11rem;
            margin-top: 0.5rem;
        }

        .base_info {
            margin-left: 3rem;
            background: #798288;
            width: 93%;
            height: 2rem;
            line-height: 2rem;
        }

        .base_info span {
            margin-left: 0.5rem;
            color: white;
            font-weight: 600;
        }

        .content {
            border: solid #d0d0d0 1px;
            background: #F9F9F9;
        }

        #listTab{
            border-right: 1px solid #ddd;
        }
    </style>
</head>
<body>
    <div id="box">
        <!--Header-part-->
        <div id="header">
            <h1 style="background-image: url('../../Content/img/loginlogo.png');"><a href="dashboard.html">Heroways</a></h1>
        </div>
        <!--close-Header-part-->
        <!--top-Header-menu-->
        <div id="user-nav" class="navbar navbar-inverse">
            <ul class="nav">
                <li class="dropdown" id="profile-messages">
                    <a title="" href="#" data-toggle="dropdown" data-target="#profile-messages" class="dropdown-toggle"><i class="icon icon-user"></i>  <span class="text">欢迎 @ViewBag.UserID</span></a>
                    @*<ul class="dropdown-menu">
                            <li><a href="#"><i class="icon-user"></i> My Profile</a></li>
                            <li class="divider"></li>
                            <li><a href="#"><i class="icon-check"></i> My Tasks</a></li>
                            <li class="divider"></li>
                            <li><a href="login.html"><i class="icon-key"></i> Log Out</a></li>
                        </ul>*@
                </li>
                <li class="dropdown" id="menu-messages">
                    <a href="#" data-toggle="dropdown" data-target="#menu-messages" class="dropdown-toggle"><i class="icon icon-cog"></i> <span class="text">帮助</span></a>
                    @*<ul class="dropdown-menu">
                            <li><a class="sAdd" title="" href="#"><i class="icon-plus"></i> new message</a></li>
                            <li class="divider"></li>
                            <li><a class="sInbox" title="" href="#"><i class="icon-envelope"></i> inbox</a></li>
                            <li class="divider"></li>
                            <li><a class="sOutbox" title="" href="#"><i class="icon-arrow-up"></i> outbox</a></li>
                            <li class="divider"></li>
                            <li><a class="sTrash" title="" href="#"><i class="icon-trash"></i> trash</a></li>
                        </ul>*@
                </li>
                <li class=""><a title="" href="#"><i class="icon icon-cog"></i> <span class="text">设置</span></a></li>
                <li class=""><a title="" href="../Login/Index"><i class="icon icon-share-alt"></i> <span class="text">注销</span></a></li>
            </ul>
        </div>
        <!--close-top-Header-menu-->
        <!--start-top-serch-->
        <div id="search">
            <input type="text" placeholder="Search here..." />
            <button type="submit" class="tip-bottom" title="Search"><i class="icon-search icon-white"></i></button>
        </div>
        <!--close-top-serch-->
        <!--sidebar-menu-->
        <div id="sidebar">
            <a href="#" class="visible-phone"><i class="icon icon-home"></i> 主页</a>
            <ul>
                <li class="active"><a href="../Home/Index"><i class="icon icon-home"></i> <span>主页</span></a> </li>
                @*<li> <a href="charts.html"><i class="icon icon-signal"></i> <span>Charts &amp; graphs</span></a> </li>*@
                <li> <a href="../../DataHandle/StationList/Index"><i class="icon icon-inbox"></i> <span>站点信息</span></a> </li>
                @*<li><a href="tables.html"><i class="icon icon-th"></i> <span>数据采集查询</span></a></li>*@
                @*<li><a href="grid.html"><i class="icon icon-fullscreen"></i> <span>Full width</span></a></li>*@
                <li class="submenu">
                    <a v-on:click="showanno" href="#"><i class="icon icon-th-list"></i> <span>数据采集查询</span><span class="label label-important">3</span></a>
                    <ul id="listmesu">
                        <li><a href="../DataHandle/RainWaterReport/PeriodResult">畅流期流速仪法流量结果计算表</a></li>
                        <li><a href="../DataHandle/RainWaterReport/Index">雨量数据</a></li>
                        <li><a href="../DataHandle/RainWaterReport/WaterIndex">水位数据</a></li>
                    </ul>
                </li>
                @*<li><a href="buttons.html"><i class="icon icon-tint"></i> <span>Buttons &amp; icons</span></a></li>
                    <li><a href="interface.html"><i class="icon icon-pencil"></i> <span>Eelements</span></a></li>
                    <li class="submenu">
                        <a href="#"><i class="icon icon-file"></i> <span>Addons</span> <span class="label label-important">5</span></a>
                        <ul>
                            <li><a href="index2.html">Dashboard2</a></li>
                            <li><a href="gallery.html">Gallery</a></li>
                            <li><a href="calendar.html">Calendar</a></li>
                            <li><a href="invoice.html">Invoice</a></li>
                            <li><a href="chat.html">Chat option</a></li>
                        </ul>
                    </li>
                    <li class="submenu">
                        <a href="#"><i class="icon icon-info-sign"></i> <span>Error</span> <span class="label label-important">4</span></a>
                        <ul>
                            <li><a href="error403.html">Error 403</a></li>
                            <li><a href="error404.html">Error 404</a></li>
                            <li><a href="error405.html">Error 405</a></li>
                            <li><a href="error500.html">Error 500</a></li>
                        </ul>
                    </li>*@
                <li class="content">
                    <span>Monthly Bandwidth Transfer</span>
                    <div class="progress progress-mini progress-danger active progress-striped">
                        <div style="width: 77%;" class="bar"></div>
                    </div>
                    <span class="percent">77%</span>
                    <div class="stat">21419.94 / 14000 MB</div>
                </li>
                <li class="content">
                    <span>Disk Space Usage</span>
                    <div class="progress progress-mini active progress-striped">
                        <div style="width: 87%;" class="bar"></div>
                    </div>
                    <span class="percent">87%</span>
                    <div class="stat">604.44 / 4000 MB</div>
                </li>
            </ul>
        </div>
        <!--sidebar-menu-->
        <!--main-container-part-->
        <div id="content" style="min-height: 89%;">
            <!--breadcrumbs-->
            <div id="content-header">
                <div id="breadcrumb"> <a href="../Home/Index" title="Go to Home" class="tip-bottom"><i class="icon-home"></i> Home</a></div>
            </div>
            <!--End-breadcrumbs-->
            <!--Action boxes-->
            <div class="container-fluid">
                <div class="content">
                    <div class="row" style="margin-bottom: 1rem;">
                        <div class="base_info">
                            <span> 区域信息</span>
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="row">
                            <div class="col-sm-1 text-center area">
                                <!--area-->
                                省
                            </div>
                            <div class="col-sm-2 select_bor">
                                <!--select_bor-->
                                <select class="form-control" name="Province" v-on:change="GetCityList($event)" id="Province">
                                    <option>==请选择==</option>
                                    <option v-for="(provice,index) in ProviceList" v-bind:value="provice.Province">{{provice.Province}}</option>
                                </select>
                            </div>
                            <div class="col-sm-1 text-center area">
                                <!--area-->
                                市
                            </div>
                            <div class="col-sm-2 select_bor">
                                <!--select_bor-->
                                <select class="form-control" name="City" id="City" v-on:change="GetCountryList(($event))">
                                    <option>==请选择==</option>
                                    <option v-for="(city,index) in CityList[0]" v-bind:value="city.City">{{city.City}}</option>
                                </select>
                            </div>
                            <div class="col-sm-1 text-center area">
                                <!--area-->
                                县/区
                            </div>
                            <div class="col-sm-2 select_bor">
                                <!--select_bor-->
                                <select class="form-control" name="Village" id="Village">
                                    <option>==请选择==</option>
                                    <option v-for="(country,index) in CountryList[0]">{{country.Country}}</option>
                                </select>
                            </div>
                        </div>

                        <div class="row" style="margin-top: 1rem;">
                            <div class="col-sm-1 text-center area">
                                站码
                            </div>
                            <div class="col-sm-4" style="margin-left:11rem;">
                                <input type="text" class="form-control" v-model="Stationid" id="Stationid" placeholder="请输入站码">
                            </div>
                            <div class="col-sm-1 text-center area">
                                站点名称
                            </div>
                            <div class="col-sm-4" style="margin-left:11rem;">
                                <input type="text" class="form-control" v-model="Stationname" id="Stationname" placeholder="请输入站点名称">
                            </div>
                        </div>

                        <div class="row" style="margin-top: 1rem;margin-bottom: 1rem;">
                            <div class="col-md-2" style="text-align:left;margin-left: 40%;">
                                <button type="button" id="btn_query" class="btn btn-primary" v-on:click="btn_Search()">查询</button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="content" style="height: 541px;overflow: auto;">
                    <div class="row" style="margin-bottom: 1rem;">
                        <div class="base_info">
                            <span> 站点列表</span>
                        </div>
                    </div>
                    <div class="widget-box" style="width: 97%;margin-left: 1rem;">
                        <div class="widget-title">
                            <span class="icon"><i class="icon-th"></i></span>
                            <!--  <h5>操 作</h5> -->
                            <div class="btn-group" style="height: 81%;margin-top: 0.2rem;">
                                <button class="btn btn-primary" style="font-size: 12px;">操作</button>
                                <button data-toggle="dropdown" class="btn btn-primary dropdown-toggle"><span class="caret"></span></button>
                                <ul class="dropdown-menu">
                                    <li><a href="../DataHandle/RainWaterReport/PeriodResult" v-on:click="GoPeriodData($event)">畅流期流速仪法流量结果计算表</a></li>
                                    <li class="divider"></li>
                                    <li><a href="../DataHandle/RainWaterReport/Index" v-on:click="GoRainData($event)">雨量数据</a></li>
                                    <li class="divider"></li>
                                    <li><a href="../DataHandle/RainWaterReport/WaterIndex" v-on:click="GoWaterData($event)">水位数据</a></li>
                                    @*<li class="divider"></li>
                                        <li><a href="#">Something else here</a></li>
                                        <li class="divider"></li>
                                        <li><a href="#">Separated link</a></li>*@
                                </ul>
                            </div>
                        </div>
                        <div class="widget-content nopadding">
                            <table class="table table-bordered" id="table_server">
                                @*<thead>
                                        <tr>
                                            <th>选择</th>
                                            <th>站点名称</th>
                                            <th>站点编码</th>
                                            <th>状态</th>
                                            <th>省</th>
                                            <th>市</th>
                                            <th>县区</th>
                                            <th>设备类型</th>
                                            <th>纬度</th>
                                            <th>经度</th>
                                            <th>备注</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        @foreach (var item in ViewBag.stationList)
                                        {
                                            <tr class="gradeX">
                                                <td><input type="radio" name="radios" /></td>
                                                <td>@item.StationName</td>
                                                <td>
                                                    @item.StationID
                                                </td>
                                                <td>@item.Onlinestate</td>
                                                <td>@item.Province</td>
                                                <td>@item.City</td>
                                                <td>
                                                    @item.County
                                                </td>
                                                <td>@item.DeviceType</td>
                                                <td>@item.Latitude</td>
                                                <td>@item.Longitude</td>
                                                <td></td>
                                            </tr>
                                        }
                                    <tr v-for="(item,index) in StationList" class="gradeX">
                                        <td><input type="radio" name="radios" /></td>
                                        <td>item.StationName}}</td>
                                        <td>
                                            item.StationID}}
                                        </td>
                                        <td>item.Onlinestate}}</td>
                                        <td>item.Province}}</td>
                                        <td>item.City}}</td>
                                        <td>
                                           item.County}}
                                        </td>
                                        <td>item.DeviceType}}</td>
                                        <td>item.Latitude}}</td>
                                        <td>item.Longitude}}</td>
                                        <td></td>
                                    </tr>
                                    </tbody>*@
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!--end-main-container-part-->
        <!--Footer-part-->

        <div class="row-fluid">
            <div id="footer" class="span12"> CopyRight © 2017 By 成都汉维斯水文监测平台 <a href="http://themedesigner.in/">Themedesigner.in</a> </div>
        </div>
    </div>
    <!--end-Footer-part-->

    <script src="~/Content/js/excanvas.min.js"></script>
    @*<script src="~/Content/js/jquery.min.js"></script>*@
    <script src="~/Content/js/jquery-3.1.1.min.js"></script>
    <script src="~/Content/js/jquery.ui.custom.js"></script>
    <script src="~/Content/js/bootstrap-table.js"></script>
    <script src="~/Content/js/bootstrap-table-zh-CN.min.js"></script> 
    <script src="~/Content/js/bootstrap.min.js"></script>

    @*<script src="~/Content/js/jquery.flot.min.js"></script>

    <script src="~/Content/js/jquery.flot.resize.min.js"></script>

    <script src="~/Content/js/jquery.peity.min.js"></script>

    <script src="~/Content/js/fullcalendar.min.js"></script>

    <script src="~/Content/js/matrix.dashboard.js"></script>

    <script src="~/Content/js/jquery.gritter.min.js"></script>

    <script src="~/Content/js/matrix.interface.js"></script>

    <script src="~/Content/js/matrix.chat.js"></script>

    <script src="~/Content/js/jquery.validate.js"></script>*@

    @*<script src="~/Content/js/matrix.form_validation.js"></script>*@

    @*<script src="~/Content/js/jquery.wizard.js"></script>

    <script src="~/Content/js/jquery.uniform.js"></script>

    <script src="~/Content/js/select2.min.js"></script>

    <script src="~/Content/js/matrix.popover.js"></script>*@

    @*<script src="~/Content/js/jquery.dataTables.min.js"></script>*@

    @*<script src="~/Content/js/matrix.js"></script>*@

    @*<script src="~/Content/js/matrix.tables.js"></script>*@
    <script src="~/Content/js/vue.min.js"></script>
    <script src="https://cdn.bootcss.com/vue-resource/1.5.0/vue-resource.min.js"></script>
    <script type="text/javascript">
  // This function is called from the pop-up menus to transfer to
  // a different page. Ignore if the value returned is a null string:
  function goPage (newURL) {

      // if url is empty, skip the menu dividers and reset the menu selection to default
      if (newURL != "") {

          // if url is "-", it is this page -- reset the menu:
          if (newURL == "-" ) {
              resetMenu();
          }
          // else, send page to designated URL
          else {
            document.location.href = newURL;
          }
      }
  }

// resets the menu selection upon entry to this page:
function resetMenu() {
   document.gomenu.selector.selectedIndex = 2;
}

    new Vue({
        el: '#box',
        data: {
            Provice: "",
            City: "",
            Country:"",
            ProviceList:[],
            CityList:[],
            CountryList: [],
            Stationid:"",
            Stationname: "",
            StationList:[],
            selectStationID:"",
            selectName:""
        },
        mounted() {
            this.init();
        },
        methods: {
            init() {
                //var sampleTags=new Array();
                @*var array = @Html.Raw(Json.Encode(@ViewBag.stationList));*@
                //for(var i=0;i<array.length;i++){
                //    sampleTags[i]=array[i];
                //}
                //alert(sampleTags);
                //this.StationList=array;
                this.btn_Search();
                this.ProviceList=@Html.Raw(Json.Encode(@ViewBag.proviceList));
                //$('#table_server').click(function(){  

                //})
            },
            showanno:function(){
                //alert(11);
                var styleObj=$("#listmesu").css("display");
                if(styleObj=="none"){
                    $("#listmesu").css("display","block");
                }else if(styleObj=="block"){
                    $("#listmesu").css("display","none");
                }             
            },
            GoRainData:function(){
                var selectContent = $('#table_server').bootstrapTable('getSelections')[0];
                if(typeof(selectContent) == 'undefined') {  
                    alert('请选择一列数据!');  
                    return;  
                }else{  
                    console.info(selectContent); 
                    console.info(selectContent.StationID);  
                    this.selectStationID=selectContent.StationID;
                    //alert(this.selectStationID);
                    this.selectName=selectContent.StationName;
                    //alert(this.selectName)
                    $(event.target).attr("href","../DataHandle/RainWaterReport/Index?StationID="+this.selectStationID+"&StationName="+encodeURIComponent(encodeURIComponent(this.selectName))); 
                }  
                
            },
            GoWaterData:function(){
                var selectContent = $('#table_server').bootstrapTable('getSelections')[0];
                if(typeof(selectContent) == 'undefined') {  
                    alert('请选择一列数据!');  
                    return false;  
                }else{  
                    console.info(selectContent); 
                    console.info(selectContent.StationID);  
                    this.selectStationID=selectContent.StationID;
                    //alert(this.selectStationID);
                    this.selectName=selectContent.StationName;
                    //alert(this.selectName)
                    $(event.target).attr("href","../DataHandle/RainWaterReport/WaterIndex?StationID="+this.selectStationID+"&StationName="+encodeURIComponent(encodeURIComponent(this.selectName))); 
                }  
                
            },
            GoPeriodData:function(){
                var selectContent = $('#table_server').bootstrapTable('getSelections')[0];
                if(typeof(selectContent) == 'undefined') {  
                    alert('请选择一列数据!');  
                    return false;  
                }else{  
                    console.info(selectContent); 
                    console.info(selectContent.StationID);  
                    this.selectStationID=selectContent.StationID;
                    //alert(this.selectStationID);
                    this.selectName=selectContent.StationName;
                    //alert(this.selectName)
                    $(event.target).attr("href","../DataHandle/RainWaterReport/PeriodResult?StationID="+this.selectStationID+"&StationName="+encodeURIComponent(encodeURIComponent(this.selectName))); 
                }  
                
            },
            GetCityList: function (event) {
                //alert(11);
                var provice = $(event.target).find("option:selected").text();
                this.Provice = provice;
                this.CityList=[];
                this.$http.post("@Url.Content("~/DataHandle/CommonHandle/GetCityList")", { provice: provice }, { emulateJSON: true }).then(function (res) {
                    alert(JSON.stringify(res.body.data));
                    this.CityList.push(res.body.data);
                }, function (res) {
                    console.log(res.status);
                });
            },
            GetCountryList:function(event){
                var city = $(event.target).find("option:selected").text();
                this.CountryList=[];
                this.$http.post("@Url.Content("~/DataHandle/CommonHandle/GetCountryList")", { provice: this.Provice,city:city }, { emulateJSON: true }).then(function (res) {
                    //alert(JSON.stringify(res.body.data));                   
                    this.CountryList.push(res.body.data);
                }, function (res) {
                    console.log(res.status);
                });
            },
            btn_Search: function () {
                this.Provice = $("#Province").find("option:selected").text();
                this.City = $("#City").find("option:selected").text();
                this.Country =$("#Village").find("option:selected").text();
                var StationID = 0;
                if (this.Stationid!="") {
                    StationID = this.Stationid
                }
                
                @*this.$http.post("@Url.Content("~/DataHandle/CommonHandle/SearchStationList")",
                    { Provice: this.Provice, City: this.City, Country: this.Country, Stationid:StationID, Stationname: this.Stationname },
                    { emulateJSON: true }).then(function (res) {
                        //alert(JSON.stringify(res.body.data));
                        //$('#listTab').dataTable().fnClearTable();
                        $('.data-table').dataTable().fnDestroy();
                        this.StationList=null;
                        this.StationList=res.body.data;
                }, function (res) {
                    console.log(res.status);
                });*@
                var provice=this.Provice;var city=this.City;
                var country=this.Country
                $("#table_server").bootstrapTable('destroy');
                var t = $("#table_server").bootstrapTable({
                url: "@Url.Content("~/DataHandle/CommonHandle/SearchStationList")",
                method: 'post',
                dataType: "json",
                striped: true,//设置为 true 会有隔行变色效果  
                undefinedText: "",//当数据为 undefined 时显示的字符  
                pagination: true, //分页  
                // paginationLoop:true,//设置为 true 启用分页条无限循环的功能。  
                //showToggle: "false",//是否显示 切换试图（table/card）按钮  
                showColumns: "true",//是否显示 内容列下拉框  
                showRefresh: true,
                pageNumber: 1,//如果设置了分页，首页页码  
                // showPaginationSwitch:true,//是否显示 数据条数选择框  
                pageSize:10,//如果设置了分页，页面数据条数  
                pageList: [10, 40, 60, 80],  //如果设置了分页，设置可供选择的页面数据条数。设置为All 则显示所有记录。  
                paginationPreText: '‹',//指定分页条中上一页按钮的图标或文字,这里是<  
                paginationNextText: '›',//指定分页条中下一页按钮的图标或文字,这里是>  
                // singleSelect: false,//设置True 将禁止多选  
                search: true, //显示搜索框  
                data_local: "zh-US",//表格汉化  
                sidePagination: "server", //服务端处理分页  
                queryParams: function (params) {//自定义参数，这里的参数是传给后台的，我这是是分页用的  
                    return {//这里的params是table提供的  
                        cp: params.offset,//从数据库第几条记录开始  
                        ps: params.limit,//找多少条  
                        StationID: StationID,
                        Provice: provice,
                        City:city,
                        Country: country
                    };
                },
                columns: [                    
                    {  
                        checkbox: true  
                    },
                    {
                        title: '站点名称',//表的列名  
                        field: 'StationName',//json数据中rows数组中的属性名  
                        align: 'center',//水平居中 
                    },
                    {
                        title: '站点编码',
                        field: 'StationID',
                        align: 'left'
                    },
                    //{
                    //    title: '差值(mm)',
                    //    field: 'DI',
                    //    align: 'left',
                    //    formatter: function (value, row, index) {
                    //        return value - row[index - 1];
                    //    }
                    //},
                    {
                        title: '状态',
                        field: 'Onlinestate',
                        align: 'left'
                    },
                    {
                        title: '省',
                        field: 'Province',
                        align: 'left'
                    },
                    {
                        title: '市',
                        field: 'City',
                        align: 'left'
                    },
                    {
                        title: '县区',
                        field: 'County',
                        align: 'left'
                    },
                    {
                        title: '设备类型',
                        field: 'DeviceType',
                        align: 'left'
                    },
                    {
                        title: '纬度',
                        field: 'Latitude',
                        align: 'left'
                    },
                    {
                        title: '经度',
                        field: 'Longitude',
                        align: 'left'
                    },
                    {
                        title: '备注',
                        field: 'Remark',
                        align: 'left'
                    },
                ]
            });
            t.on('load-success.bs.table', function (data) {//table加载成功后的监听函数  
                // console.log("load success");
                $(".pull-right").css("display", "block");
            });
            $("#table_server thead").find("tr").css("background", "#1bbc9b");
            $("#table_server thead").find("tr").css("color", "white");
           }
        }
    })
</script>
</body>
</html>
